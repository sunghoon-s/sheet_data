# Google Apps Script 코드 분석

## 📋 코드 개요
이 Google Apps Script 코드는 Google Sheets의 데이터를 웹 페이지로 표시하는 웹 앱을 만듭니다.

## 🔍 코드 분석

### 주요 기능
- **doGet()**: HTTP GET 요청을 처리하는 메인 함수
- Google Sheets에서 데이터를 읽어와 HTML 테이블로 변환
- 웹 브라우저에서 스프레드시트 데이터를 볼 수 있도록 함

### 코드 구조 분석

#### 1. 스프레드시트 접근
```javascript
const ss = SpreadsheetApp.openById("1E2KH0fWsOd7Gywbx8qPzNyilNAE1EJWwWGffBAzf0VM");
const sheet = ss.getSheetByName("data");
```
- **SpreadsheetApp.openById()**: 특정 ID로 스프레드시트 열기
- **getSheetByName()**: "data" 시트 선택

#### 2. 에러 처리
```javascript
if (sheet) {
  // 시트가 존재할 때의 처리
} else {
  // 시트가 없을 때의 에러 메시지
}
```
- 시트 존재 여부 확인으로 안정성 향상
- 시트가 없을 경우 사용자에게 알림

#### 3. 데이터 처리
```javascript
const data = sheet.getDataRange().getValues();
```
- **getDataRange()**: 시트의 모든 데이터 범위 가져오기
- **getValues()**: 2차원 배열로 데이터 반환

#### 4. HTML 생성
```javascript
data.forEach((row, index) => {
  html += "<tr>";
  row.forEach(cell => {
    html += index === 0
      ? `<th>${cell}</th>`
      : `<td>${cell}</td>`;
  });
  html += "</tr>";
});
```
- 첫 번째 행은 헤더(`<th>`)로 처리
- 나머지 행은 데이터 셀(`<td>`)로 처리

## 🆚 이전 버전과의 차이점

### 이전 버전
- 시트명: "App_Test Data분석"
- 에러 처리 없음
- 코드가 한 줄로 연결됨

### 현재 버전 (개선사항)
- 시트명: "data" (더 간단함)
- **에러 처리 추가**: 시트가 없을 때 적절한 메시지 표시
- **코드 가독성 향상**: 변수 분리 및 구조화
- **안정성 향상**: null 체크로 런타임 에러 방지

## 🚀 배포 방법

1. **Google Apps Script 프로젝트 생성**
   - script.google.com 접속
   - 새 프로젝트 생성
   - Code.gs 파일에 코드 붙여넣기

2. **웹 앱으로 배포**
   - 배포 > 새 배포
   - 유형: 웹 앱
   - 실행 계정: 본인
   - 액세스 권한: 모든 사용자 (또는 조직 내)

3. **권한 승인**
   - 스프레드시트 읽기 권한 필요
   - 처음 실행 시 Google 계정 인증

## ⚙️ 설정 요구사항

### 스프레드시트 설정
- 스프레드시트 ID: `1E2KH0fWsOd7Gywbx8qPzNyilNAE1EJWwWGffBAzf0VM`
- 시트명: `data`
- 첫 번째 행: 헤더 정보 포함 권장

### 브라우저 지원
- 모든 최신 브라우저 지원
- 모바일 기기에서도 접근 가능

## 🔧 커스터마이징 옵션

### CSS 스타일 추가
```javascript
let html = `<html>
<head>
  <title>data 시트</title>
  <style>
    table { border-collapse: collapse; width: 100%; }
    th, td { padding: 12px; text-align: left; }
    th { background-color: #4CAF50; color: white; }
    tr:nth-child(even) { background-color: #f2f2f2; }
  </style>
</head>
<body>`;
```

### 필터링 기능 추가
```javascript
// 특정 조건에 맞는 데이터만 표시
const filteredData = data.filter(row => row[0] !== "");
```

## 📈 사용 사례
- 실시간 데이터 대시보드
- 팀 내 데이터 공유
- 고객용 데이터 조회 페이지
- 보고서 자동 생성
